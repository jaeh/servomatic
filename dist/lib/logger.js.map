{"version":3,"sources":["../../src/lib/logger.js"],"names":[],"mappings":";;;;;;;;IACO,MAAM,2BAAM,QAAQ;;IACnB,IAAI,WAAO,MAAM,EAAjB,IAAI;;IACiB,OAAO,WAAO,IAAI,EAAvC,iBAAiB;;IAClB,MAAM,2BAAM,QAAQ;;IACpB,KAAK,2BAAM,aAAa;;IACvB,IAAI,WAAO,aAAa,EAAxB,IAAI;;IAEN,MAAM,GACC,SADP,MAAM,CACE,GAAG,EAAa;MAAX,IAAI,gCAAG,EAAE;;wBADtB,MAAM;;AAER,MAAI,GAAG,GAAW,OAAO,CAAC,GAAG,EAAE;MAC3B,GAAG,GAAW,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC;MAC9B,WAAW,GAAG;AACZ,UAAM,EAAE;AACN,YAAM,EAAE,OAAO,CAAE,IAAI,CAAC,GAAG,EAAE,YAAY,CAAC,EAAE,EAAC,KAAK,EAAE,GAAG,EAAC,CAAE;AACxD,UAAI,EAAE,cAAU,GAAG,EAAE,GAAG,EAAE;AAAE,eAAO,GAAG,CAAC,UAAU,IAAI,GAAG,CAAA;OAAE;KAC7D;AACC,OAAG,EAAK;AACN,YAAM,EAAE,OAAO,CAAE,IAAI,CAAC,GAAG,EAAE,WAAW,CAAC,EAAE,EAAC,KAAK,EAAE,GAAG,EAAC,CAAE;AACvD,UAAI,EAAE,cAAU,GAAG,EAAE,GAAG,EAAE;AAAE,eAAO,GAAG,CAAC,UAAU,GAAG,GAAG,CAAA;OAAE;KAC5D;GACF;MACC,IAAI,GAAU,KAAK,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;AAC3C,GAAC;;AAED,MAAI,CAAC,IAAI,EAAE,UAAC,GAAG,EAAK;AAClB,OAAG,CAAC,GAAG,CAAE,MAAM,CAAC,UAAU,EAAE,GAAG,CAAC,CAAE,CAAA;GACnC,CAAC,CAAC;CACJ;;iBAGY,MAAM","file":"src/lib/logger.js","sourcesContent":["//logging middleware\nimport morgan from 'morgan';\nimport {join} from 'path';\nimport {createWriteStream as wStream} from 'fs';\nimport mkdirp from 'mkdirp';\nimport merge from 'magic-merge';\nimport {each} from 'magic-loops';\n\nclass Logger {\n  constructor(app, opts = {}) {\n    var cwd         = process.cwd()\n      , dir         = join(cwd, 'log')\n      , defaultOpts = {\n          access: {\n            stream: wStream( join(dir, 'access.log'), {flags: 'a'} )\n          , skip: function (req, res) { return res.statusCode >= 400 }\n        }\n        , err   : {\n            stream: wStream( join(dir, 'error.log'), {flags: 'a'} )\n          , skip: function (req, res) { return res.statusCode < 400 }\n        }\n      }\n      , logs        = merge(opts, defaultOpts);\n    ;\n\n    each(logs, (log) => {\n      app.use( morgan('combined', log) )\n    });\n  }\n}\n\nexport default Logger;\n"]}